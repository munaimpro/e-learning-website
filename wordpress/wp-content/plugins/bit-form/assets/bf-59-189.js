var A=Object.defineProperty;var g=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var b=(d,r,a)=>r in d?A(d,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[r]=a,m=(d,r)=>{for(var a in r||(r={}))z.call(r,a)&&b(d,a,r[a]);if(g)for(var a of g(r))D.call(r,a)&&b(d,a,r[a]);return d};import{r as C,a as U,j as e,_ as n,y as V,ba as M,b as y,L as S,a5 as W,B as w,c as I}from"./main-601.js";import{i as x}from"./bf-548-69.js";import{B as G}from"./bf-409-72.js";import{B as J}from"./bf-428-359.js";function H({formID:d,formFields:r,webHooks:a,setWebHooks:p,step:K,setstep:T,setSnackbar:o,create:$,isInfo:i}){var v;const j=s=>s==null?void 0:s.match(/(\?|&)([^=]+)=([^&]+|)/gi),[P,h]=C.useState(!1),E=["GET","POST","PUT","PATCH","OPTION","DELETE","TRACE","CONNECT"],{css:L}=U(),f=C.useRef(null),_=s=>{try{return JSON.stringify(s,null,2)}catch(t){return s}},B=s=>{h(!0),I({hookDetails:s},"bitforms_test_webhook").then(t=>{if(t&&t.success)f.current.innerHTML=`<pre>${_(t.data.response)}</pre>`,o({show:!0,msg:n(t.data.msg)}),h(!1);else if(t&&t.data){const l=typeof t.data=="string"?t.data:"Unknown error";o({show:!0,msg:`${l}. ${n("please try again")}`}),h(!1)}else o({show:!0,msg:n("Webhook tests failed. please try again")}),h(!1)})},N=(s,t,l)=>{const c=m({},a);t!==""?s==="key"?c.url=c.url.replace(l,`${l.charAt(0)}${t}=${l.split("=")[1]}`):c.url=c.url.replace(l,`${l.split("=")[0]}=${t}`):l.match(/\?/g)===null?c.url=c.url.replace(l,""):c.url=c.url.replace(`${l}&`,"?"),p(c)},u=s=>{const t=m({},a);t[s.target.name]=s.target.value,p(m({},t))},k=(s,t)=>{const l=m({},a),c=t.split("=");c[1]=s,l.url=l.url.replace(t,c.join("=")),p(l)},F=()=>{const s=m({},a);s.url.match(/\?/g)!==null?s.url+="&key=value":s.url+="?key=value",p(s)},R=s=>{const t=m({},a);t.url=t.url.replace(s,""),p(t)},O=()=>{setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),T(2)};return e.jsxs("div",{style:{width:i&&900},children:[e.jsx("div",{className:"flx ",children:e.jsxs("div",{className:"w-7 mr-2 mb-4 mt-2",children:[e.jsx("div",{className:"f-m",children:n("Integration name")}),e.jsx("input",{name:"name",onChange:s=>u(s),className:"btcd-paper-inp mt-1",type:"text",value:a.name,disabled:i})]})}),e.jsxs("div",{className:"flx flx-start",children:[e.jsxs("div",{className:"w-7",children:[e.jsx("div",{className:"f-m",children:n("Link:")}),e.jsx("input",{name:"url",onChange:s=>u(s),className:"btcd-paper-inp mt-1",type:"text",value:a.url,disabled:i}),(a==null?void 0:a.apiConsole)&&e.jsxs("small",{className:"d-blk mt-2",children:[n("To got Webhook , Please Visit")," ",e.jsx("a",{className:"btcd-link",href:a.apiConsole,target:"_blank",rel:"noreferrer",children:n(`${a.type} Dashboard`)})]})]}),e.jsxs("div",{className:"w-3 px-1",children:[e.jsx("div",{className:"f-m",children:n("Method:")}),e.jsx("select",{name:"method",onChange:s=>u(s),defaultValue:a.method,className:"btcd-paper-inp mt-1",disabled:i,children:E.map((s,t)=>e.jsx("option",{value:s,children:s},`method-${t*2}`))})]})]}),e.jsx("br",{}),e.jsx("div",{className:"f-m",children:n("Add Url Parameter: (optional)")}),e.jsx("div",{className:"btcd-param-t-wrp mt-1",children:e.jsxs("div",{className:"btcd-param-t",children:[e.jsxs("div",{className:"tr",children:[e.jsx("div",{className:"td",children:n("Key")}),e.jsx("div",{className:"td",children:n("Value")})]}),j(a.url)!==null&&((v=j(a.url))==null?void 0:v.map((s,t)=>e.jsxs("div",{className:"tr",children:[e.jsx("div",{className:"td",children:e.jsx("input",{className:"btcd-paper-inp p-i-sm",onChange:l=>N("key",l.target.value,s),type:"text",value:s.split("=")[0].substr(1),disabled:i})}),e.jsx("div",{className:"td",children:e.jsx("input",{className:"btcd-paper-inp p-i-sm",onChange:l=>N("val",l.target.value,s),type:"text",value:s.split("=")[1],disabled:i})}),!i&&e.jsxs("div",{className:"flx p-atn",children:[e.jsx(x,{onClick:()=>R(s),icn:!0,children:e.jsx(V,{size:16})}),e.jsxs("select",{className:"btcd-paper-inp p-i-sm",name:"",id:"",onChange:l=>k(l.target.value,s),defaultValue:s.split("=")[1],children:[e.jsx("option",{value:"",children:"Select One"}),e.jsx(J,{formFields:r,notAllowFieldType:["file-up","advanced-file-up"],shortCode:!0})]})]})]},`fu-1${t*3}`))),!i&&e.jsx(x,{onClick:()=>F(),className:"add-pram",icn:!0,children:e.jsx(M,{size:"14",className:"icn-rotate-45"})})]})}),!i&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{onClick:()=>B(a),className:L(y.btn,y.btn_blue_otln),children:[n("Test Webhook"),P&&e.jsx(S,{size:14,clr:"#022217",className:"ml-2"}),e.jsx(W,{size:18,className:"ml-1"})]}),e.jsxs("div",{className:"wh-resp-box",children:[e.jsx("div",{className:"f-m wh-resp-box-title",children:n("Response:")}),e.jsx("div",{className:"wh-resp-box-content",ref:f,children:"Test Webhook to see the response."})]})]}),e.jsxs("small",{className:"d-blk mt-2 mb-2",children:[n("Try our free webhook test website: "),e.jsx("a",{className:"btcd-link",href:"https://app.webhook.is/test",target:"_blank",rel:"noreferrer",children:"https://app.webhook.is/test"})]}),$&&e.jsxs(w,{variant:"success",onClick:()=>O(),type:"button",children:[n("Next"),e.jsx(G,{className:"ml-1 rev-icn"})]})]})}export{H as default};
